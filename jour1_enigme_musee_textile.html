<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Le Murmure de la Haute-Laine</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Montserrat:wght@300;400;500&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
  :root{
    --ink:#3e332c;
    --gold: #b48a64; 
    --gold-light: rgba(180,138,100,0.42);
    --paper: rgba(255,254,252,0.95);
    --accent:#8f6d4f;
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family:"Montserrat", sans-serif;
    color:var(--ink);
    min-height:100vh;
    /* L'image de fond */
    background: url("images/fond_textile_detail.jpg") center/cover no-repeat fixed;
    overflow-x:hidden;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* --- MODIFICATION EFFET "VIEILLE PHOTO" --- */
  body::before{
    content:"";
    position:fixed;
    inset:0;
    
    /* Au lieu du noir, un voile S√©pia / Dor√© tr√®s l√©ger au centre, et un peu plus chaud sur les bords */
    background:
      radial-gradient(circle at center, rgba(220, 200, 180, 0.2), rgba(120, 90, 60, 0.5));
      
    /* LE SECRET DU LOOK VINTAGE : S√©pia + L√©ger contraste + Flou minime */
    backdrop-filter: sepia(50%) contrast(1.1) blur(1px);
    -webkit-backdrop-filter: sepia(50%) contrast(1.1) blur(1px);
    
    pointer-events:none;
    z-index:0;
  }
  /* ------------------------------------------- */

  main{
    position:relative;
    z-index:1;
    max-width: 850px;
    width: 90%;
    margin: 4vh auto;
    padding: 0;
  }

  .envelope{
    position:relative;
    background: var(--paper);
    border-radius: 20px;
    box-shadow: 0 20px 50px rgba(62, 40, 20, 0.25); /* Ombre teint√©e brun chaud */
    overflow:hidden;
    border: 1px solid rgba(180,138,100,0.45);
    text-align: center;
  }

  .envelope-header{ padding: 50px 30px 10px; }

  .title{
    font-family: 'Great Vibes', cursive;
    color: var(--gold);
    font-size: clamp(2.5rem, 7vw, 3.5rem);
    margin: 0 0 15px;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    line-height: 1.2;
  }

  .subtitle{
    margin:0 auto;
    max-width: 720px;
    line-height:1.85;
    font-weight: 300;
    font-size: 1.1rem;
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    color: rgba(62,51,44,0.85);
  }

  .thread{
    position:relative;
    padding: 10px 30px 50px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .thread-content{
    width: 100%;
    max-width: 700px;
    margin: 0 auto;
  }

  .para{
    margin: 0 0 20px;
    line-height: 1.9;
    font-size: 1.05rem;
    color: var(--ink);
  }

  .center{ text-align:center; display: flex; justify-content: center; width: 100%; }
  .hidden{ display:none !important; }

  .sep{
    height:1px;
    width: 60%;
    margin: 30px auto;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    opacity: 0.6;
  }

  .audio-btn-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
  }
  
  .btn-couture {
      width: 76px;
      height: 76px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, #9c7e63, #5e4635);
      box-shadow: 
        0 10px 25px rgba(0,0,0,0.25), 
        inset 0 2px 5px rgba(255,255,255,0.3),
        inset 0 -2px 5px rgba(0,0,0,0.3);
      border: 3px solid #bba58e;
      cursor: pointer;
      position: relative;
      transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex;
      align-items: center;
      justify-content: center;
  }
  
  .btn-couture:hover { transform: scale(1.05); }
  .btn-couture:active { transform: scale(0.95); }

  .btn-couture::after {
      content: "";
      position: absolute;
      width: 50px; height: 50px;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
  }

  .stitch-cross {
      position: relative;
      width: 16px; height: 16px;
  }
  .stitch-cross::before {
     content: ""; position: absolute; top:0; left:0; right:0; bottom:0;
     background: transparent;
     border-radius: 50%;
     box-shadow: 
        -6px -6px 0 #2a1f18, 
        6px -6px 0 #2a1f18, 
        -6px 6px 0 #2a1f18, 
        6px 6px 0 #2a1f18;
  }
  .stitch-cross::after {
      content: "+";
      font-family: sans-serif;
      font-weight: 100;
      font-size: 28px;
      color: #eaddcf; 
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -54%);
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  }

  .audio-label {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1rem;
      font-style: italic;
      color: var(--gold);
      margin-top: 15px;
      letter-spacing: 1px;
  }

  .sewn-label-input {
      background-color: #fdfbf7;
      border: 1px solid var(--gold);
      border-radius: 4px;
      padding: 15px 25px;
      font-family: 'Great Vibes', cursive;
      font-size: 1.8rem;
      color: var(--accent);
      text-align: center;
      width: min(300px, 80vw);
      box-shadow: 0 5px 15px rgba(180,138,100,0.1);
      outline: none;
      transition: all 0.3s;
  }
  
  .sewn-label-input:focus {
      border-color: var(--ink);
      background-color: #fff;
      box-shadow: 0 5px 20px rgba(180,138,100,0.2);
  }

  .sewn-label-input::placeholder {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      color: rgba(180,138,100,0.5);
      font-style: italic;
  }

  .btn{
    display:inline-block;
    padding: 16px 35px;
    border-radius: 50px;
    background: var(--gold);
    color: #fff;
    text-decoration:none;
    font-weight: 600;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 1px;
    text-transform: uppercase;
    font-size: 0.85rem;
    border: 1px solid transparent;
    box-shadow: 0 10px 20px rgba(180,138,100,0.25);
    cursor:pointer;
    transition: all 0.3s ease;
  }
  .btn:hover { 
      background: #fff; 
      color: var(--gold); 
      border-color: var(--gold);
      transform: translateY(-2px);
  }
  
  .btn.secondary{ 
      background: transparent; 
      color: var(--ink);
      border: 1px solid var(--ink);
      box-shadow: none;
  }
  .btn.secondary:hover {
      background: var(--ink);
      color: #fff;
  }

  .btn.archive{ 
      background: linear-gradient(135deg, #b48a64 0%, #8f6d4f 100%);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.3);
  }

  .seal-panel{
    margin: 20px auto;
    background: #fff;
    border-radius: 12px;
    border: 1px solid rgba(180,138,100,0.2);
    padding: 30px 20px;
    max-width: 600px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
  }
  .wax{
    width: 40px; height: 40px; border-radius: 50%;
    display:inline-flex; align-items: center; justify-content: center;
    background: radial-gradient(circle at 30% 25%, #d4af37, #996515); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    color: #fff; font-size: 18px; font-weight:bold; font-family: 'Great Vibes', cursive;
    margin-right: 10px;
  }

  .step-block {
    display: none;
    animation: fadeIn 1s ease forwards;
    margin-top: 30px;
  }
  
  @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
  }

  .inner-card{
    background: rgba(255,255,255,0.8);
    border: 1px solid rgba(180,138,100,0.3);
    border-radius: 8px;
    padding: 40px 30px;
    position: relative;
    box-shadow: 0 15px 35px rgba(0,0,0,0.08);
  }

  .section-title{
    font-family: 'Great Vibes', cursive;
    color: var(--gold);
    font-size: 2.8rem;
    margin: 0 0 20px;
    line-height: 1.2;
  }

  .museum-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ink);
      margin: 20px 0;
      letter-spacing: 0.5px;
  }

  .helper{
    margin-top: 15px;
    font-size: 0.95rem;
    color: #a85a5a;
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
  }

  .organisation{
    margin: 30px auto;
    padding: 30px;
    border-top: 1px solid var(--gold-light);
    border-bottom: 1px solid var(--gold-light);
    max-width: 650px;
  }
  .organisation h4{ 
      margin: 0 0 15px; 
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem; 
      color: var(--gold); 
      text-transform: uppercase;
      letter-spacing: 2px;
  }

  #son-toggle{
    position: fixed; bottom: 20px; right: 20px;
    width: 50px; height: 50px; border-radius: 50%;
    background: #fff;
    color: var(--gold);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    display:grid; place-items:center; cursor:pointer; z-index: 100;
    font-size: 1.2rem;
    border: 1px solid var(--gold-light);
  }
</style>
</head>

<body>
<main>
  <div class="envelope" id="scene">

    <div class="envelope-header">
      <div class="title">Le Murmure de la Haute-Laine</div>
      <p class="subtitle">
        Le fil du temps ne s‚Äôest jamais rompu ici.<br>
        Entre ces murs, des gestes anciens ont √©t√© transmis, silencieusement.
      </p>
    </div>

    <div class="thread">
      
      <div class="thread-content">
        <p class="para">Lorsque vous √™tes pr√™ts, laissez le murmure vous guider.</p>

        <div class="audio-btn-wrapper">
            <div class="btn-couture" id="btnAudio" title="Lire le murmure">
                <div class="stitch-cross"></div>
            </div>
            <div class="audio-label">√âcouter le secret</div>
        </div>
        <audio id="audioMusee" src="audios/murmure-laine.mp3"></audio>

        <div class="sep"></div>

        <div class="seal-panel" id="sealed">
          <p class="para" style="font-style:italic;">
            Une enveloppe vous attend.<br>
            Elle ne contient pas une r√©ponse‚Ä¶ mais un nom.
          </p>

          <button class="btn" id="btnOpen">
            <span class="wax">M</span> Ouvrir l‚Äôenveloppe
          </button>
        </div>

        <div class="step-block" id="enigmeStep">
          <div class="inner-card">
            <div class="section-title">Le Mot du Murmure</div>

            <p class="para">Le murmure ne donne pas de r√©ponse. Il rappelle ce que ce lieu est.</p>
            <p class="para">Ce que vous allez visiter conserve la m√©moire et raconte le temps.</p>
            
            <p class="para" style="font-family:'Cormorant Garamond'; font-style:italic; font-size:1.2rem; margin-top:30px;">
                √âcrivez le mot que vous avez entendu :
            </p>

            <div class="center">
              <input id="reponse" type="text" placeholder="Votre r√©ponse..." class="sewn-label-input" autocomplete="off">
            </div>

            <div class="center" style="margin-top: 30px;">
              <button class="btn" id="btnValider">Valider</button>
            </div>

            <p id="erreur" class="helper hidden">
              Ce mot n‚Äôest ni cach√©, ni compliqu√©. Il a d√©j√† √©t√© prononc√©.
            </p>
          </div>
        </div>

        <div class="step-block" id="paperStep">
            <div class="inner-card">
                <div class="section-title">Le Mot est Juste</div>
                
                <p class="para">
                    La m√©moire est virtuelle, mais l'exp√©rience est r√©elle.<br>
                    Pour franchir le seuil, il vous faut la cl√© physique.
                </p>

                <div class="sep" style="width:30%;"></div>

                <p class="para" style="font-size:1.2rem; color:var(--gold);">
                    Cherchez l'enveloppe marqu√©e du sceau :
                </p>
                <p class="title" style="font-size:2.5rem; margin:10px 0;">"Activit√© Jour 1"</p>

                <p class="para">
                    √Ä l'int√©rieur dort votre droit de passage.
                </p>

                <div class="center" style="margin-top: 35px;">
                    <button class="btn secondary" id="btnGotTicket">
                        üéüÔ∏è J'ai le billet en main
                    </button>
                </div>
            </div>
        </div>

        <div class="step-block" id="revealStep">
            <div class="sep"></div>

            <div class="section-title">Bienvenue au Mus√©e</div>

            <p class="para">
              Vous √™tes attendus l√† o√π la m√©moire se conserve<br>
              et continue de vivre.
            </p>

            <div class="museum-name">
              Mus√©e D√©partemental du Textile<br>
              de Labastide-Rouairoux
            </div>

            <div class="sep"></div>

            <p class="para" style="font-style:italic;">
              Si vous le souhaitez, laissez une archive vous raconter<br>
              ce que ce lieu a vu.
            </p>

            <div class="center" style="margin-top: 20px;">
              <a class="btn archive" href="https://www.youtube.com/watch?v=rKJydhNMoeE" target="_blank" rel="noopener">
                üìú Voir l‚Äôarchive vid√©o
              </a>
            </div>

            <div class="organisation">
              <h4>Organisation de l‚ÄôApr√®s-midi</h4>
              <p>Ouverture : <strong>14h00 ‚Äî 18h00</strong></p>
              <p>Visites guid√©es : <strong>14h15 ¬∑ 15h30 ¬∑ 16h45</strong></p>
              <p style="font-style: italic; font-size:0.95rem; margin-top:20px; opacity:0.8;">
                Prenez le temps de choisir la visite qui vous appelle.<br>
                Les fils de l‚Äôhistoire n‚Äôattendent plus que vous.
              </p>
            </div>

            <div class="center" style="margin-top: 40px; margin-bottom: 20px;">
              <a href="jour1_accueil.html" class="btn secondary">
                Valider cette √©tape & Poursuivre le voyage
              </a>
            </div>
        </div>

      </div>
    </div>

  </div>
</main>

<div id="son-toggle" title="Son">üîä</div>
<audio id="audioFond" src="audios/riviere.mp3" loop></audio>

<script>
  const audioMusee = document.getElementById("audioMusee");
  const btnAudio = document.getElementById("btnAudio");
  const fond = document.getElementById("audioFond");
  const sonToggle = document.getElementById("son-toggle");

  const btnOpen = document.getElementById("btnOpen");
  const sealed = document.getElementById("sealed");
  
  const enigmeStep = document.getElementById("enigmeStep");
  const btnValider = document.getElementById("btnValider");
  const reponse = document.getElementById("reponse");
  const erreur = document.getElementById("erreur");

  const paperStep = document.getElementById("paperStep");
  const btnGotTicket = document.getElementById("btnGotTicket");

  const revealStep = document.getElementById("revealStep");

  if (fond) {
    fond.volume = 0.22;
    document.addEventListener('click', () => {
      if (fond.paused) fond.play().catch(()=>{});
    }, { once:true });

    sonToggle.addEventListener("click", () => {
      if (fond.paused) { fond.play().catch(()=>{}); sonToggle.textContent = "üîä"; }
      else { fond.pause(); sonToggle.textContent = "üîá"; }
    });
  }

  btnAudio.addEventListener("click", () => {
    btnAudio.style.transform = "scale(0.9)";
    setTimeout(() => btnAudio.style.transform = "scale(1)", 150);
    audioMusee.play().catch(()=>{});
  });

  btnOpen.addEventListener("click", () => {
    sealed.style.display = "none";
    enigmeStep.style.display = "block";
    setTimeout(()=> reponse.focus({ preventScroll:true }), 350);
  });

  btnValider.addEventListener("click", () => {
    const val = reponse.value.trim().toLowerCase()
      .normalize("NFD").replace(/\p{Diacritic}/gu,"");

    if (val === "musee") {
      erreur.classList.add("hidden");
      enigmeStep.style.display = "none";
      paperStep.style.display = "block";
      paperStep.scrollIntoView({ behavior: "smooth", block: "start" });
    } else {
      erreur.classList.remove("hidden");
      reponse.style.borderColor = "#a85a5a";
      setTimeout(() => reponse.style.borderColor = "#b48a64", 1000);
    }
  });

  reponse.addEventListener("keydown", (e) => {
    if (e.key === "Enter") btnValider.click();
  });

  btnGotTicket.addEventListener("click", () => {
      localStorage.setItem("jour1_musee_ok","true");
      paperStep.style.display = "none";
      revealStep.style.display = "block";
      revealStep.scrollIntoView({ behavior: "smooth", block: "start" });
  });
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ—ï¸ La PremiÃ¨re Clef de la Haute-Laine</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">

<style>
/* DÃ©finition des couleurs thÃ©matiques */
:root {
    --color-cacao-dark: #4F352C;    /* Brun Cacao / Titres */
    --color-millÃ©sime-gold: #B48A64; /* Or/Vin */
    --color-beige-textile: #F7F4F0; 
    --color-text-dark: #3E332C;
    --color-leaf: #7A905D;          /* Couleur verte pour le thÃ¨me nature/printemps */
    --color-error-red: #d9534f;
    --color-light-bg: rgba(255, 250, 240, 0.95); /* Fond blanc cassÃ© semi-transparent pour les encarts */
}

/* ğŸŒ¿ STYLE GLOBAL */
body {
    font-family: 'Lato', sans-serif;
    color: var(--color-text-dark);
    margin: 0;
    padding: 0;
    line-height: 1.7;
    overflow-x: hidden;
    scroll-behavior: smooth;
    
    background: url('images/fond_atelier_textile.jpg') center/cover no-repeat fixed;
    background-size: cover;
}

/* â¬…ï¸ CONTENEUR PRINCIPAL DE STYLE "ENVELOPE" */
main {
    max-width: 900px;
    margin: 4vw auto; 
    padding: 25px;
}

.bloc-contenu {
    background: var(--color-light-bg); 
    padding: 40px 30px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    text-align: left;
    max-width: 800px;
    margin: 0 auto;
}

/* TITRES */
h1 {
    font-family: 'Cormorant Garamond', serif;
    color: var(--color-cacao-dark);
    font-size: 2.4rem; 
    font-weight: 700;
    text-align: center;
    margin-bottom: 20px;
}
.titre-icone {
    display: inline-block;
    color: var(--color-millÃ©sime-gold); 
    font-size: 2.4rem; 
    margin-right: 15px;
}

h2 { font-size: 1.8rem; color: var(--color-millÃ©sime-gold); margin-top: 2rem; }
h3 { font-size: 1.3rem; margin-top: 1rem; }

/* BLOCS DÃ‰ROULANTS */
details {
    background: rgba(255, 255, 255, 0.95); 
    border: 2px solid var(--color-millÃ©sime-gold); 
    border-radius: 12px;
    box-shadow: 2px 4px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
    padding: 10px 15px;
    overflow: hidden;
    transition: all 0.5s ease;
}
summary {
    font-weight: bold;
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.2rem;
    color: var(--color-cacao-dark);
    cursor: pointer;
    outline: none;
    text-transform: uppercase;
    text-align: center;
}
/* SUPPRESSION DES Ã‰TOILES */
summary:before { content: ""; margin-right: 0; }
summary:after { content: ""; margin-left: 0; }

details[open] { background: var(--color-light-bg); box-shadow: 0 0 15px rgba(79, 53, 44, 0.3); }

/* BOUTONS DE CHOIX */
.choix-halte { text-align: center; margin: 25px 0; }
.bouton-action { 
    display: inline-block; 
    padding: 12px 25px; 
    margin: 10px; 
    border-radius: 4px; 
    text-decoration: none; 
    font-weight: bold; 
    text-transform: uppercase; 
    transition: all 0.3s ease; 
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); 
    text-align: center;
    width: auto;
}
.bouton-dejeuner { background-color: var(--color-millÃ©sime-gold); color: #fff; border: 2px solid var(--color-millÃ©sime-gold); }
.bouton-dejeuner:hover { background-color: #9d7553; }
.bouton-continuer { background-color: var(--color-beige-textile); color: var(--color-cacao-dark); border: 2px solid var(--color-millÃ©sime-gold); }
.bouton-continuer:hover { background-color: #f2eeda; }
.encadre-direction { background-color: #FFF4E8; border: 2px solid var(--color-millÃ©sime-gold); border-radius: 8px; padding: 10px; text-align: center; font-weight: bold; margin: 20px auto; width: fit-content; font-size: 1.1rem; }

/* INPUT & BOUTON ENIGME */
#reponse { padding: 10px; border-radius: 6px; border: 2px solid var(--color-millÃ©sime-gold); width: 60%; max-width: 300px; margin-right: 10px; }
#valider { background-color: var(--color-error-red); color: #fff; border: none; border-radius: 6px; padding: 10px 20px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; }
#valider:hover { background-color: #c24541; }
.message-feedback { text-align: center; margin-top: 20px; font-family: 'Cormorant Garamond', serif; font-size: 1.1rem; color: var(--color-error-red); }

/* â¬…ï¸ STYLES DE LA RÃ‰VÃ‰LATION (SUCCÃˆS) */
#revelation-destination {
    display: none;
    text-align: center;
    margin-top: 30px;
    padding: 20px;
    border: 3px dashed var(--color-leaf);
    border-radius: 12px;
}
.succes-titre {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.8rem;
    font-weight: bold;
    color: var(--color-leaf);
    margin: 0;
    line-height: 1.2;
}
#panneau-container {
    position: relative; 
    display: inline-block;
    width: 95%; 
    max-width: 400px;
    margin: 20px auto 15px;
}
#panneau-img {
    width: 100%;
    height: auto;
    display: block;
}
#panneau-texte {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-family: 'Lato', sans-serif;
    font-weight: bold;
    font-size: clamp(0.9rem, 4vw, 1.3rem); 
    color: var(--color-error-red); 
    white-space: nowrap;
    text-transform: uppercase;
}

#bouton-route { display: none; background-color: var(--color-cacao-dark); color: #FAF5E8; border: 2px solid var(--color-cacao-dark); border-radius: 8px; padding: 12px 25px; font-weight: bold; margin-top: 20px; text-decoration: none; transition: all 0.3s ease; animation: pulseGlow 2.5s infinite; }
#bouton-route:hover { background-color: #3b2b24; }

/* ANIMATIONS */
@keyframes pulseGlow { 0% { box-shadow: 0 0 6px rgba(255, 223, 150, 0.4); } 50% { box-shadow: 0 0 16px rgba(255, 223, 150, 0.8); } 100% { box-shadow: 0 0 6px rgba(255, 223, 150, 0.4); } }
.fade-in { opacity: 0; transform: translateY(10px); animation: fadeSlide 0.8s forwards; }
details[open] .fade-in > * { animation-delay: 0.3s; }
@keyframes fadeSlide { to { opacity: 1; transform: translateY(0); } }

/* FOOTER & SON (Rendu comme un bouton thÃ©matique) */
footer { 
    text-align: center; 
    margin: 40px 0 20px; 
}
.btn-footer-retour { 
    display: inline-block; 
    text-decoration: none; 
    background-color: var(--color-cacao-dark); 
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: bold;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
    transition: background-color 0.3s, transform 0.2s;
    text-transform: uppercase;
    font-size: 0.95rem;
}
.btn-footer-retour:hover { 
    background-color: #3b2b24; 
    transform: translateY(-2px);
}


#son-toggle { position: fixed; bottom: 15px; right: 15px; background: #DCD7C9; border: 2px solid var(--color-cacao-dark); color: var(--color-cacao-dark); border-radius: 50%; width: 40px; height: 40px; text-align: center; line-height: 38px; cursor: pointer; font-size: 1.1rem; transition: all 0.3s ease; }
#son-toggle:hover { background: #EBE6D8; }

/* Mobile */
@media (max-width: 600px) {
    main { padding: 0; }
    .bloc-contenu { margin: 5vw; padding: 20px; }
    h1 { font-size: 2rem; margin-top: 5vw; }
    #reponse { width: 90%; margin-right: 0; margin-bottom: 10px; }
    .choix-halte { display: flex; flex-direction: column; }
    .bouton-action { width: 90%; box-sizing: border-box; }
}
</style>
</head>

<body>

<div id="map-watermark"></div> 
<main>
    <div class="bloc-contenu">
Â  <h1><span class="titre-icone">ğŸ—ï¸</span> La PremiÃ¨re Clef de la Haute-Laine</h1>
Â Â 
Â  <details open class="fade-in" id="bloc-appel">
Â  Â  <summary><strong>L'APPEL DU CHEMIN</strong></summary>
Â  Â  <p class="fade-in" style="text-align:center;">
Â  Â  Â  Chers Papou & Manou,<br>
Â  Â  Â  Le moment est venu de laisser derriÃ¨re vous l'horizon connu.<br>
Â  Â  Â  La premiÃ¨re page du voyage est ouverte.
Â  Â  </p>

Â  Â  <div class="encadre-direction fade-in">ğŸ§­ Direction : Saint-Pons-de-ThomiÃ¨res</div>

Â  Â  <p class="fade-in" style="text-align:center;">
Â  Â  Â  âœ¨ <strong>HALTE GOURMANDE FACULTATIVE</strong><br>
Â  Â  Â  Sur la route, un doux dÃ©tour s'offre Ã  vous : si la faim se fait sentir ou si l'envie d'une pause s'impose,
Â  Â  Â  le village de Saint-Pons-de-ThomiÃ¨res vous invite Ã  un dÃ©jeuner tranquille ou Ã  une pause cafÃ©.<br>
Â  Â  Â  Laissez votre humeur guider votre arrÃªt.<br><br>
Â  Â  Â  L'air du Languedoc vous guidera ensuite vers le secret qui y est cachÃ©...
Â  Â  </p>

Â  Â  <div class="choix-halte fade-in">
Â  Â  Â  <p>Alors, quel est votre choix ?</p>
Â  Â  Â  <a href="#" id="btnPause" class="bouton-action bouton-dejeuner">ğŸ´ Pause Gourmande Ã  Saint-Pons</a>
Â  Â  Â  <a href="#" id="btnContinuer" class="bouton-action bouton-continuer">ğŸš€ Le MystÃ¨re Nous Attend, Continuons !</a>
Â  Â  </div>
Â  </details>

Â  <details id="dejeuner-st-pons" class="fade-in">
Â  Â  <summary><strong>PAUSE GOURMANDE Ã€ SAINT-PONS</strong></summary>
Â  Â  <p style="text-align:center;"><strong>â˜• Le Temps d'un Souffle</strong><br>
Â  Â  C'est un choix sage et gourmand. L'aventure n'en sera que plus douce le ventre plein !</p>

Â  Â  <details>
Â  Â  Â  <summary>ğŸ½ï¸ Option DÃ©jeuner</summary>
Â  Â  Â  <ul>
Â  Â  Â  Â  <li><strong>Auberge du Marronnier</strong> â€” <em>Maison ancienne, poutres et cheminÃ©e, cuisine du terroir dÃ¨s 22 â‚¬.</em></li>
Â  Â  Â  Â  <li><strong>La Table du Boucher</strong> â€” <em>Ambiance conviviale et moderne, plats copieux et gÃ©nÃ©reux.</em></li>
Â  Â  Â  Â  <li><strong>La Cantine de Tonton</strong> â€” <em>Ã€ Courniou (8 min), rustique-chic, plats faits maison, ambiance joyeuse.</em></li>
Â  Â  Â  </ul>
Â  Â  </details>

Â  Â  <details><summary>â˜• Option CafÃ©</summary>
Â  Â  Â  <p>Un cafÃ© ou une boulangerie pour une pause rapide avant de reprendre la route des Ã©nigmes.</p>
Â  Â  </details>

Â  Â  <details><summary>ğŸ§º Option Pique-nique</summary>
Â  Â  Â  <p>Si le cÅ“ur vous en dit, cherchez un coin paisible au bord du Jaur, le temps d'un pique-nique improvisÃ©.</p>
Â  Â  </details>

Â  Â  <p style="text-align:center;"><strong>ğŸŒ¾ Le Voyage Reprend</strong><br>
Â  Â  Quand vos cÅ“urs et vos estomacs seront rassasiÃ©s, cliquez ci-dessous pour continuer vers l'Ã©nigme.</p>

Â  Â  <div style="text-align:center;">
Â  Â  Â  <a href="#" id="btnContinuerEnigme" class="bouton-action bouton-dejeuner">â¬‡ï¸ Continuer vers l'Ã‰nigme</a>
Â  Â  </div>
Â  </details>

Â  <details id="enigme-labastide" class="fade-in">
Â  Â  <summary><strong>ğŸ¡ LA CACHETTE DES TISSEURS</strong></summary>

Â  Â  <p style="text-align:center; font-style:italic;">
Â  Â  Â  "Le vent d'Ã©tÃ© a effacÃ© le nom sur la carte."<br> Trouvez la premiÃ¨re destination de notre pÃ©riple en Languedoc.<br>
Â  Â  Â  </p>

Â  Â  <h3>ğŸŒ¿ Le Fil Conducteur de l'Ã‰tape</h3>
Â  Â  <p>
Â  Â  Â  Redonnez un nom Ã  l'Ã©tape suivante.<br> Les indices historiques sont le seul chemin pour atteindre cette destination cachÃ©e.<br>
Â  Â  </p>

Â  Â  <h3>ğŸ” Indice Principal</h3>
Â  Â  <p>
Â  Â  Â  Muni des indices : Â« VallÃ©e du ThorÃ© Â» et Â« Haute-Laine Â», quelle est notre destination ?<br><br>
Â  Â  Â  â€¢ Elle est historiquement surnommÃ©e la <em>capitale du dÃ©lainage</em> et a prospÃ©rÃ© grÃ¢ce Ã  la filature au XIXáµ‰ siÃ¨cle.<br>
Â  Â  Â  â€¢ Elle est lovÃ©e au cÅ“ur du Parc Naturel RÃ©gional du Haut-Languedoc.<br>
Â  Â  Â  â€¢ Son nom est composÃ© de deux parties, comme un couple uni.<br><br>
Â  Â  Â  ğŸª¶ Lâ€™Ã©nigme du jour se dÃ©bloque en inscrivant le nom complet de ce village du Tarn<br>
Â  Â  Â  <em>(sans tiret ni majuscule, pour simplifier la saisie)</em>.
Â  Â  </p>

Â  Â  <div style="text-align:center; margin-top:20px;">
Â  Â  Â  <input type="text" id="reponse" placeholder="Entrez le nom de la communeâ€¦">
Â  Â  Â  <button id="valider">ğŸ”“ Valider</button>
Â  Â  Â  <div id="message" class="message-feedback"></div>

        <div id="revelation-destination">
            <h2 class="succes-titre">
                âœ¨ Les fils sont dÃ©liÃ©s !<br>
                La destination est trouvÃ©e :
            </h2>
            <div id="panneau-container">
                <img id="panneau-img" src="images/panneau.jpg" alt="Panneau de Labastide-Rouairoux" />
                <span id="panneau-texte">LABASTIDE-ROUAIROUX</span>
            </div>
            
            <a href="jour1_accueil.html" id="bouton-route" class="bouton-action bouton-dejeuner">
                âœ… En route vers Le Savoir-Faire OubliÃ©
            </a>
        </div>
        Â  Â  </div>

Â  Â  <div style="text-align:center; margin-top:25px;">
Â  Â  Â  <button id="btn-indice-secours">ğŸ’­ J'ai besoin d'un murmure d'indice</button>
Â  Â  </div>

Â  Â  <div id="indice-cache" style="display:none; margin-top:20px; border-left:3px solid var(--color-cacao-dark); padding-left:12px;">
Â  Â  Â  <p><strong>ğŸ” L'Indice de Secours PoÃ©tique</strong></p>
Â  Â  Â  <p><em>â€œSi le chemin se fait brumeux, Ã©coutez le vent.<br>
Â  Â  Â  Il murmure deux mots qui se collent ensemble,<br>
Â  Â  Â  dÃ©signant d'abord la maison forte,<br>
Â  Â  Â  puis le buisson Ã©pineux.<br>
Â  Â  Â  C'est l'union de ces deux lieux qui vous donnera la rÃ©ponse.â€</em></p>

Â  Â  Â  <p>ğŸ—ï¸ <strong>RÃ©vÃ©lation :</strong><br>
Â  Â  Â  â€¢ Maison forte â†’ <em>Labastide</em><br>
Â  Â  Â  â€¢ Buisson Ã©pineux â†’ <em>Rouairoux</em></p>
Â  Â  </div>
Â  </details>

Â  <footer>
Â  Â  <a href="jour1_accueil.html" class="btn-footer-retour">â¡ï¸ En route vers le savoir-faire oubliÃ©</a>
Â  </footer>
</main>

<div id="son-toggle">ğŸ”Š</div>

<script>
// ClÃ© de progression pour dÃ©verrouiller la Vignette 3 (HÃ´tel) du menu.
const STATE_MUSEE_RESOLU = 'jour1_musee_ok'; 
const STATE_DEPART_ACCESSIBLE = 'jour1_depart_ok'; // ClÃ© pour la vignette 2

// 1. DÃ©finition des sons 
const sonPrincipal = new Audio('audios/ete.mp3');Â 
sonPrincipal.loop = true;
sonPrincipal.volume = 0.25;Â 

const sonMix = new Audio('audios/cigales.mp3');Â 
sonMix.loop = true;
sonMix.volume = 0.15;Â 

const sonToggle = document.getElementById("son-toggle");
let audioInitie = false;
let sonActif = false; 

function startAudioIfNecessary() {
Â  Â  if (!audioInitie) {
Â  Â  Â  Â  sonPrincipal.play().catch(e => console.error("Erreur lecture son principal:", e));
Â  Â  Â  Â  sonMix.play().catch(e => console.error("Erreur lecture son mix:", e));
Â  Â  Â  Â  audioInitie = true;
Â  Â  Â  Â  sonActif = true; 
Â  Â  Â  Â  sonToggle.textContent = "ğŸ”Š"; 
Â  Â  }
}

/* ğŸ¯ Gestion du bouton Mute */
sonToggle.addEventListener("click", () => {
Â  Â  startAudioIfNecessary();Â 

Â  Â  if (audioInitie) { 
Â  Â  Â  Â  if (sonActif) { 
Â  Â  Â  Â  Â  Â  sonPrincipal.pause();Â 
Â  Â  Â  Â  Â  Â  sonMix.pause();
Â  Â  Â  Â  Â  Â  sonToggle.textContent = "ğŸ”‡";Â 
Â  Â  Â  Â  } else { 
Â  Â  Â  Â  Â  Â  sonPrincipal.play();Â 
Â  Â  Â  Â  Â  Â  sonMix.play();
Â  Â  Â  Â  Â  Â  sonToggle.textContent = "ğŸ”Š";Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  sonActif = !sonActif; 
Â  Â  }
});

/* ğŸ¯ Gestion des blocs et Ã©nigme */
const blocPause = document.getElementById("dejeuner-st-pons");
const blocEnigme = document.getElementById("enigme-labastide");
const btnPause = document.getElementById("btnPause");
const btnContinuer = document.getElementById("btnContinuer");
const btnContinuerEnigme = document.getElementById("btnContinuerEnigme");
const btnIndiceSecours = document.getElementById("btn-indice-secours"); 
const indiceCache = document.getElementById("indice-cache"); 

function ouvrirBloc(bloc) {
Â  bloc.open = true;
Â  bloc.scrollIntoView({ behavior: "smooth" });
Â  bloc.classList.add("fade-in");
}
function fermerBloc(bloc) { bloc.open = false; }

// Logique pour ouvrir et fermer les blocs dÃ©roulants
btnPause.addEventListener("click", e => { e.preventDefault(); ouvrirBloc(blocPause); fermerBloc(blocEnigme); });
btnContinuer.addEventListener("click", e => { e.preventDefault(); ouvrirBloc(blocEnigme); fermerBloc(blocPause); });

// Logique cruciale : Clic sur ce bouton dÃ©verrouille la vignette 2 (Ã©nigme) dans le menu central
btnContinuerEnigme.addEventListener("click", e => { 
    e.preventDefault(); 
    ouvrirBloc(blocEnigme); 
    fermerBloc(blocPause); 
    
    // â¬…ï¸ MARQUAGE DE LA PROGRESSION POUR LA VIGNETTE 2 DU MENU
    const urlParams = new URLSearchParams(window.location.search);
    const previewMode = urlParams.get('preview') === 'true';
    if (!previewMode) {
        localStorage.setItem(STATE_DEPART_ACCESSIBLE, 'true');
    }
});

const btnValider = document.getElementById("valider");
const inputRep = document.getElementById("reponse");
const message = document.getElementById("message");
const boutonRoute = document.getElementById("bouton-route");
const revelationDestination = document.getElementById("revelation-destination"); 

btnValider.addEventListener("click", () => {
Â  const reponse = inputRep.value.toLowerCase().replace(/[\s-]/g, '');
    // Le mot de passe complet (avec ou sans trait d'union/espaces) et les parties sont acceptÃ©es
Â  if (["labastiderouairoux", "labastide", "rouairoux"].includes(reponse)) { 
Â  Â  message.style.display = 'none'; // Masque le message de feedback initial
    revelationDestination.style.display = 'block'; // â¬…ï¸ AFFICHE LE BLOC DE SUCCÃˆS
    inputRep.style.display = 'none'; // Masque l'input de rÃ©ponse
    btnValider.style.display = 'none'; // Masque le bouton valider
Â  Â  
Â  Â  // MARQUAGE DE LA PROGRESSION POUR LA VIGNETTE 3 (HÃ”TEL)
Â  Â  localStorage.setItem(STATE_MUSEE_RESOLU, 'true');
Â  Â  revelationDestination.scrollIntoView({ behavior: 'smooth', block: 'start' });

Â  } else {
Â  Â  message.textContent = "Hmmâ€¦ le fil sâ€™emmÃªle encore un peu ! Essayez autrement ğŸ’­";
Â  Â  message.style.color = "var(--color-error-red)"; // Couleur rouge pour Ã©chec
    message.style.display = 'block'; // Affiche le message de feedback
Â  }
});

btnIndiceSecours.onclick = function() {
Â  document.getElementById('indice-cache').style.display = 'block';
Â  this.style.display = 'none';
};

// Initialisation de l'audio au premier clic sur le document
document.addEventListener('click', startAudioIfNecessary, { once: true });
</script>
</body>
</html>